<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel | TheScaleHub</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

  <div id="navbar"></div>

  <!-- ========== ADMIN HEADER ========== -->
  <section class="dashboard-header">
    <div class="container">
      <h1>âš™ï¸ Admin Panel</h1>
      <p>Manage blog posts, view stats, and control your content.</p>
    </div>
  </section>

  <!-- ========== ADMIN CONTENT ========== -->
  <div id="adminContent">
    <div class="admin-layout">

      <!-- Status message -->
      <div id="adminMsg" class="admin-msg hidden"></div>

      <!-- ========== CREATE / EDIT POST FORM ========== -->
      <div class="admin-form-card">
        <h3 id="postFormTitle">ğŸ“ Create New Post</h3>
        <form id="postForm" onsubmit="return handleCreatePost(event)">
          <input type="hidden" id="editPostId" value="">

          <div class="form-group">
            <label for="postTitle">Post Title <span style="color:var(--danger);">*</span></label>
            <input type="text" id="postTitle" required placeholder="Enter post title">
          </div>

          <div class="form-group">
            <label for="postContent">Content <span style="color:var(--danger);">*</span></label>
            <textarea id="postContent" rows="8" required placeholder="Write your blog post content here..."></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="postLink">External Link <span style="color:var(--gray-400);font-weight:400;">(optional)</span></label>
              <input type="url" id="postLink" placeholder="https://example.com/article">
            </div>
            <div class="form-group">
              <label for="postImage">Image URL <span style="color:var(--gray-400);font-weight:400;">(optional)</span></label>
              <input type="url" id="postImage" placeholder="https://example.com/image.jpg">
            </div>
          </div>

          <div class="toggle-row">
            <label class="toggle-switch">
              <input type="checkbox" id="postPublished" checked>
              <span class="toggle-slider"></span>
            </label>
            <span style="font-weight:600;font-size:0.9rem;color:var(--gray-700);">Publish immediately</span>
          </div>

          <div style="display:flex;gap:0.75rem;flex-wrap:wrap;">
            <button type="submit" class="btn btn-primary btn-lg" id="postSubmitBtn">ğŸ“ Publish Post</button>
            <button type="button" onclick="document.getElementById('postForm').reset();document.getElementById('editPostId').value='';document.getElementById('postFormTitle').textContent='ğŸ“ Create New Post';document.getElementById('postSubmitBtn').textContent='ğŸ“ Publish Post';" class="btn btn-secondary">Cancel Edit</button>
          </div>
        </form>
      </div>

      <!-- ========== EXISTING POSTS ========== -->
      <div class="admin-form-card">
        <h3>ğŸ“‹ All Posts</h3>
        <div id="adminPostsList">
          <p style="text-align:center;color:var(--gray-500);padding:2rem;">Loading posts...</p>
        </div>
      </div>

      <!-- ========== QUICK LINKS ========== -->
      <div class="admin-form-card">
        <h3>ğŸ”— Quick Links</h3>
        <div style="display:flex;gap:0.75rem;flex-wrap:wrap;">
          <a href="blog.html" class="btn btn-secondary btn-sm">ğŸ“° View Blog</a>
          <a href="dashboard.html" class="btn btn-secondary btn-sm">ğŸ“Š Dashboard</a>
          <a href="index.html" class="btn btn-secondary btn-sm">ğŸ  Homepage</a>
        </div>
      </div>

    </div>
  </div>

  <div id="footer"></div>

  <!-- ========== SCRIPTS ========== -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="modules-data.js"></script>
  <script src="app.js"></script>
  <script>
    renderNavbar('admin');
    renderFooter();

    // Wait for Firebase auth to resolve, then check admin
    function initAdmin() {
      if (firebaseReady && auth) {
        auth.onAuthStateChanged((user) => {
          currentUser = user;
          renderNavbar('admin');
          renderAdminPanel();
        });
      } else {
        // Firebase not ready - still try to render (will show error)
        setTimeout(() => renderAdminPanel(), 500);
      }
    }
    // Small delay to ensure Firebase initializes
    setTimeout(initAdmin, 300);
  </script>
</body>
</html>
